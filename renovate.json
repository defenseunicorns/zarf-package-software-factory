{
  "extends": [
    "config:base"
  ],
  "labels": [
    "renovate"
  ],
  "prHourlyLimit": 0,
  "prBodyNotes": [
    "- :warning: The E2E tests need to be run, they have a manual trigger. To start them add a comment to this PR that says `/test all`",
    "{{#if (containsString depType 'zarfcomponents')}}- :warning: Please ensure the images are also updated in `zarf.yaml`. Hint: Try using `zarf prepare find-images`. Right now this process is manual (add commits to this branch), but we intend to automate it later.{{/if}}",
    "{{#if (containsString depType 'bigbang')}}- :warning: Please ensure the git repos that Big Bang depends on are also updated in `zarf.yaml`. You can find them by going to [values.yaml](https://repo1.dso.mil/platform-one/big-bang/bigbang/-/blob/{{newVersion}}/chart/values.yaml) in the Big Bang repo in the `<subrepo>.git.tag` parameter for each repo. Right now this process is manual (add commits to this branch), but we intend to automate it later.{{/if}}",
    "{{#if (containsString depType 'buildharness-deps')}}- :warning: The Build Harness image needs to be manually released after this PR is merged. Run [this GitHub Action](https://github.com/defenseunicorns/zarf-package-software-factory/actions/workflows/build-build-harness.yml) to kick it off. We intend to make this more automated at some point.{{/if}}"
  ],
  "pre-commit": {
    "enabled": true
  },
  "packageRules": [
    {
      "matchDepTypes": [
        "buildharness-deps"
      ],
      "groupName": "buildharness-deps"
    }
  ],
  "regexManagers": [
    // Big Bang version
    {
      "fileMatch": [
        "^zarf.yaml$",
        "^Makefile$"
      ],
      "matchStrings": [
        "https:\/\/repo1\\.dso\\.mil\/platform-one\/big-bang\/bigbang\\.git@(?<currentValue>\\S+)",
        "BIGBANG_VERSION := (?<currentValue>\\S+)"
      ],
      "depNameTemplate": "https://repo1.dso.mil/platform-one/big-bang/bigbang.git",
      "packageNameTemplate": "bigbang",
      "datasourceTemplate": "git-tags",
      "depTypeTemplate": "zarfcomponents-bigbang"
    },
    // Zarf version
    {
      "fileMatch": [
        "^zarf\\.yaml$",
        "^Makefile$",
        "^\\.pre-commit-config\\.yaml$"
      ],
      "matchStrings": [
        "https:\/\/raw\\.githubusercontent\\.com\/defenseunicorns\/zarf\/(?<currentValue>\\S+)\/zarf\\.schema\\.json",
        "ZARF_VERSION := (?<currentValue>\\S+)"
      ],
      "depNameTemplate": "https://github.com/defenseunicorns/zarf.git",
      "packageNameTemplate": "zarf",
      "datasourceTemplate": "git-tags",
      "depTypeTemplate": "zarfbin"
    },
    // Build Harness version
    {
      "fileMatch": [
        "^Makefile$"
      ],
      "matchStrings": [
        "BUILD_HARNESS_VERSION := (?<currentValue>\\S+)"
      ],
      "depNameTemplate": "ghcr.io/defenseunicorns/zarf-package-software-factory/build-harness",
      "packageNameTemplate": "build-harness",
      "datasourceTemplate": "docker",
      "depTypeTemplate": "buildharness"
    },
    // ASDF version
    {
      "fileMatch": [
        "^Dockerfile$",
        "^.tool-versions$"
      ],
      "matchStrings": [
        "ARG ASDF_VERSION=\"(?<currentValue>\\S+)\""
      ],
      "depNameTemplate": "https://github.com/asdf-vm/asdf.git",
      "packageNameTemplate": "asdf",
      "datasourceTemplate": "git-tags",
      "depTypeTemplate": "buildharness-deps"
    },
    // Golang version
    {
      "fileMatch": [
        "^Dockerfile$",
        "^.tool-versions$"
      ],
      "matchStrings": [
        "^ARG GOLANG_VERSION=\"(?<currentValue>\\S+)\"$",
        "^golang (?<currentValue>\\S+)$"
      ],
      "depNameTemplate": "https://github.com/golang/go.git",
      "packageNameTemplate": "golang",
      "datasourceTemplate": "golang-version",
      "depTypeTemplate": "buildharness-deps"
    },
    // golangci-lint version
    {
      "fileMatch": [
        "^Dockerfile$",
        "^.tool-versions$"
      ],
      "matchStrings": [
        "^ARG GOLANGCILINT_VERSION=\"(?<currentValue>\\S+)\"$",
        "^golangci-lint (?<currentValue>\\S+)$"
      ],
      "depNameTemplate": "https://github.com/golangci/golangci-lint.git",
      "packageNameTemplate": "golangci-lint",
      "datasourceTemplate": "git-tags",
      "depTypeTemplate": "buildharness-deps"
    }
  ]
}
